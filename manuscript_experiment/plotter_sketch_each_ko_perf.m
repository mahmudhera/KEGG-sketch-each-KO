
memories = [18.8383583984375 19.993937500000005 24.010418945312498 31.163740234375002 39.8977548828125 48.396673828124996 55.538240234374996 64.6873837890625 70.25367578125 80.5926806640625 
8.475459960937501 15.701673828125001 21.8565048828125 26.130646484375 30.385555664062498 33.86004785156249 36.7755302734375 39.020399414062496 41.4305068359375 43.3267001953125 
6.883367187499999 15.462142578125 24.3455 32.214927734374996 39.9463828125 46.6030908203125 53.505373046875 59.24420996093751 64.914677734375 70.6469931640625 
5.8426904296875 13.9128291015625 21.887469726562504 29.146855468749997 36.364443359375 42.779380859374996 49.087672851562495 55.0891708984375 60.119998046875004 65.825224609375 ];

meories_error = [0.6133603161651193 0.43633384464623476 1.4767064582746643 3.660039741600001 2.870664385885068 0.9927690448629739 3.7436295877259336 0.35104702078263317 7.170252645147652 0.45162855223571363 
0.31849128723953024 0.8288512044846894 0.4308402838304342 0.9966871498965105 0.8077106029645552 0.9417133058392183 0.7731480857597224 1.0733771113300181 1.0829666623019603 0.9856143394425858 
0.34218935395317723 1.0397937994920128 0.6500735026513039 0.8130805134337453 0.7122737921921548 1.1781701678716776 0.7613337097470464 1.248204316206497 1.0774023150442353 1.15230427849217 
0.3295177881666463 0.4788247699577063 0.3155820685303306 0.57996017156522 0.7420473548296586 1.1953780406836239 0.6355009175953515 0.9621285231705312 1.7615623931630282 1.1697305713482316 ];

category_names = {'1M', '2M', '3M', '4M', '5M', '6M', '7M', '8M', '9M', '10M'};

Y = memories';
Y_er = meories_error';
cat_label = categorical(category_names); %The Group Label
cat_label = reordercats(cat_label,category_names);%To Preserve Label Order
b = bar(Y,'grouped', 'BarWidth', 1.0);

set(gcf, 'units', 'inch', 'position',[0, 0, 8.5, 4]);
set(gca, 'FontName', 'Arial');
hold on;
grid on;
% Calculate the number of groups and number of bars in each group
[ngroups,nbars] = size(Y);
% Get the x coordinate of the bars
x = nan(nbars, ngroups);
for i = 1:nbars
    x(i,:) = b(i).XEndPoints;
end
errorbar(x',Y,Y_er,'k','linestyle','none','LineWidth', 0.9);%Adding the errorbars
hold off
set(gca,'xticklabel',cat_label);
legend('Diamond', 'sourmash, k=7', 'sourmash, k=11', 'sourmash, k=15', 'Location', 'Best');

title('Memory required to idnetify KOs by various approaches', 'FontSize', 11);
xlabel('Number of reads in simulated metagenome', 'FontSize', 10);
ylabel('Average memory used (GB)', 'FontSize', 10);

set(gcf, 'PaperUnits', 'inches');
set(gcf, 'PaperSize', [8.5 4]);
print(gcf, 'large_MGs_memory.pdf', '-dpdf', '-bestfit');

%%

times = [568.2395300000001 1125.7196500000002 1123.78725 1657.9617300000002 1906.8228099999997 1879.0549500000002 2546.95953 2703.90638 2779.4675 3458.0355499999996 
1040.2116700000001 1437.05324 2200.71089 2106.62336 2495.83344 2636.5895100000002 2839.34307 3305.40374 3184.3090800000004 3331.88259 
572.78581 966.93074 1226.65122 1633.3239999999998 1728.53627 2151.1374100000003 2976.94291 2646.0855800000004 3053.21105 3161.89233 
521.06488 982.9666599999998 1157.2600399999997 1697.06396 1753.36372 2050.50921 2542.10358 2678.56486 2606.79153 3221.37863];

times_error = [239.4377698868708 444.47092516731675 254.00493928818096 542.2174790071804 549.2859676455888 220.44403753963158 549.7326772083138 304.3590153240044 609.5638190835772 470.7301890169043 
154.0441698443992 315.48116466422584 293.38677374297043 620.7333554894923 471.96556901773926 861.1720852327535 577.8887178911855 459.51134838709737 975.0447472362044 887.4585056079259 
111.2797046763106 336.7952661684846 302.8040685700171 332.6030482527573 682.9003530641013 514.8728833653846 441.87860372688215 582.5648874856496 325.93154239073965 646.8159977655935 
105.36203552586483 165.47549984827484 335.2265448870844 301.5704041084078 415.6798839995021 551.4264431284565 513.7399948308343 783.262071229159 772.1018799191555 457.3156926630335 ];

category_names = {'1M', '2M', '3M', '4M', '5M', '6M', '7M', '8M', '9M', '10M'};

Y = times';
Y_er = times_error';
cat_label = categorical(category_names); %The Group Label
cat_label = reordercats(cat_label,category_names);%To Preserve Label Order
b = bar(Y,'grouped', 'BarWidth', 1.0);

set(gcf, 'units', 'inch', 'position',[0, 0, 8.5, 4]);
set(gca, 'FontName', 'Arial');
hold on;
grid on;
% Calculate the number of groups and number of bars in each group
[ngroups,nbars] = size(Y);
% Get the x coordinate of the bars
x = nan(nbars, ngroups);
for i = 1:nbars
    x(i,:) = b(i).XEndPoints;
end
errorbar(x',Y,Y_er,'k','linestyle','none','LineWidth', 0.9);%Adding the errorbars
hold off
set(gca,'xticklabel',cat_label);
legend('Diamond', 'sourmash, k=7', 'sourmash, k=11', 'sourmash, k=15', 'Location', 'Best');

title('Running time for identifying KOs by various approaches', 'FontSize', 11);
xlabel('Number of reads in simulated metagenome', 'FontSize', 10);
ylabel('Average running time (seconds)', 'FontSize', 10);

set(gcf, 'PaperUnits', 'inches');
set(gcf, 'PaperSize', [8.5 4]);
print(gcf, 'large_MGs_runtime.pdf', '-dpdf', '-bestfit');

%%

f1s = [0.8802436418747221 0.8847301712742383 0.8860843657589562 0.8880619749489485 0.8895848911653286 0.8896259142881779 0.8899486754404429 0.8908775978321698 0.8904215463771511 0.8905484084161788 
0.6715665616642701 0.7181313347724188 0.7230685168947353 0.7388980066802864 0.7378723562249454 0.7431702587019238 0.7446958692641404 0.7509462412611092 0.7498215403085229 0.7513044461567894 
0.8136862040606132 0.8432734149969336 0.8654431141980883 0.8684417027831037 0.8836455977074962 0.8887103544491444 0.8891871663348496 0.8952142981548598 0.8977455192162015 0.8990073275891041 
0.8121020899390465 0.8363578700417402 0.8656865204411686 0.8720934905977167 0.8835722483906086 0.8891791996209022 0.8909364026250156 0.8916305708625766 0.8979649662463085 0.9000452651024572];

f1s_error = [0.00415494695123008 0.005273069453116441 0.006574323964031832 0.005443651305338725 0.005766889229244332 0.006142412153790997 0.00648552314417106 0.006079503730739759 0.006474026021830293 0.006966635807099837 
0.006488733250767203 0.010496590338849227 0.011638860931837039 0.004251095680655672 0.0030698958928829785 0.010245637166506113 0.0041535889225810555 0.007823694988449406 0.008467429975855326 0.004399384885449049 
0.0037309795603263896 0.0038639536500277806 0.0031169767656818717 0.0025908049368146965 0.0032270427130010825 0.0031997973665810675 0.002211854566680539 0.004144013850516707 0.002856954089284434 0.0029998614429398445 
0.002958730989839101 0.0037075740342993333 0.0025388769021336285 0.0017204188022984282 0.002399435915054255 0.0017140448805185904 0.0015769960525631804 0.0026591063615494237 0.0018536485020472038 0.001627776636061025 ];

category_names = {'1M', '2M', '3M', '4M', '5M', '6M', '7M', '8M', '9M', '10M'};

Y = f1s'*100;
Y_er = f1s_error'*100;
cat_label = categorical(category_names); %The Group Label
cat_label = reordercats(cat_label,category_names);%To Preserve Label Order
b = bar(Y,'grouped', 'BarWidth', 1.0);

set(gcf, 'units', 'inch', 'position',[0, 0, 8.5, 4]);
set(gca, 'FontName', 'Arial');
hold on;
grid on;
% Calculate the number of groups and number of bars in each group
[ngroups,nbars] = size(Y);
% Get the x coordinate of the bars
x = nan(nbars, ngroups);
for i = 1:nbars
    x(i,:) = b(i).XEndPoints;
end
errorbar(x',Y,Y_er,'k','linestyle','none', 'LineWidth', 0.9);%Adding the errorbars
hold off
set(gca,'xticklabel',cat_label);
legend('Diamond', 'sourmash, k=7', 'sourmash, k=11', 'sourmash, k=15', 'Location', 'west');
title('F1 scores in identifying KOs by various approaches', 'FontSize', 11);
xlabel('Number of reads in simulated metagenome', 'FontSize', 10);
ylabel('Average F1 score', 'FontSize', 10);

set(gcf, 'PaperUnits', 'inches');
set(gcf, 'PaperSize', [8.5 4]);
print(gcf, 'large_MGs_F1.pdf', '-dpdf', '-bestfit');

%%

recalls = [0.8617672300082674 0.8691224800254214 0.8689941469921448 0.8714762695154663 0.8732203446733745 0.873877180607319 0.874464183116754 0.8753224108870136 0.8751028417232399 0.8751047462412679 
0.5346864531762008 0.6003978223061072 0.6009592471629777 0.6245243700408295 0.6186676662056506 0.6270048843103341 0.6289664407689564 0.6393331355572553 0.6362728589465385 0.6379271462648548 
0.8225186823580289 0.793539213187585 0.87046212558917 0.9121977865442167 0.8709023376880269 0.899407507417639 0.9189014402135331 0.8866392604270988 0.8973003923149246 0.91049247237624 
0.8029387613292563 0.7874706242388564 0.8577758300227245 0.9037782212891011 0.8603682203803912 0.8895108869425797 0.9103736956261628 0.9040660521954076 0.8892341547452458 0.9040838972720966];

recalls_error = [0.011729224365943609 0.011528227853333364 0.010930248396914494 0.01019371743486841 0.00998644745385738 0.01029700585794212 0.009947556669971743 0.01076347223974885 0.010085746433622525 0.010755326320193841 
0.007897276893951819 0.017780223115634826 0.02081018877938863 0.006090068262141849 0.0052025168485997095 0.01809195728933342 0.005854541914707609 0.013660360212439193 0.01511465058674041 0.006330887586211051 
0.006818609398847307 0.006535672467911275 0.005900378613534366 0.0030578463378402314 0.005790099892872271 0.006332341111502415 0.004798206242514291 0.012983668041781337 0.005686693638269487 0.0062331479948933175 
0.004997605162987171 0.04071468008873657 0.005048851453070757 0.0045798766548551745 0.004219775479728076 0.002552073337471258 0.0028025065278328336 0.02703456743527988 0.003081920057606242 0.0024697565980176814 ];

category_names = {'1M', '2M', '3M', '4M', '5M', '6M', '7M', '8M', '9M', '10M'};

Y = recalls'*100;
Y_er = recalls_error'*100;
cat_label = categorical(category_names); %The Group Label
cat_label = reordercats(cat_label,category_names);%To Preserve Label Order
b = bar(Y,'grouped', 'BarWidth', 1.0);

set(gcf,'units', 'inch', 'position',[0, 0, 8.5, 4]);
set(gca, 'FontName', 'Arial');
hold on
grid on
% Calculate the number of groups and number of bars in each group
[ngroups,nbars] = size(Y);
% Get the x coordinate of the bars
x = nan(nbars, ngroups);
for i = 1:nbars
    x(i,:) = b(i).XEndPoints;
end
errorbar(x',Y,Y_er,'k','linestyle','none', 'LineWidth', 0.9);%Adding the errorbars
hold off
set(gca,'xticklabel',cat_label);
legend('Diamond', 'sourmash, k=7', 'sourmash, k=11', 'sourmash, k=15', 'Location', 'Best');
title('Recalls in identifying KOs by various approaches', 'FontSize', 11);
xlabel('Number of reads in simulated metagenome', 'FontSize', 10);
ylabel('Average recall', 'FontSize', 10);

set(gcf, 'PaperUnits', 'inches');
set(gcf, 'PaperSize', [8.5 4]);
print(gcf, 'large_MGs_recall.pdf', '-dpdf', '-bestfit');

%%

precisions = [0.8997921667430727 0.9011350055893483 0.9040579325073029 0.9054644057096011 0.906728306930997 0.9061343942328219 0.9061674816032518 0.9071795220328471 0.9064673761414811 0.9067190486855352 
0.9027584328161596 0.8941455690443778 0.9087047127659365 0.9046258128829565 0.9140497235670295 0.9129378984637873 0.9126823958538839 0.9101931241134509 0.9132289213152059 0.9137528305949619 
0.8050772689494353 0.8996985661424658 0.8605135631238727 0.8287075577267649 0.8968022944848373 0.8783021392064526 0.8613574420024268 0.9045022083606827 0.8982294106690863 0.8878516411869238 
0.8215194723685025 0.8965895227312869 0.8737699333252993 0.8425830140345258 0.9080829594283525 0.8888569787220236 0.8723185360612261 0.8813594438026293 0.9068822231683106 0.896050692325673];

precisions_error = [0.010802046232565823 0.010674823670584244 0.011620503894883729 0.010133839599430193 0.009879845517721595 0.011211439705071718 0.011745132182819482 0.010764946317963013 0.01180068230392544 0.011374969061685676 
0.0034237140539712554 0.009476944930399075 0.01307166489859919 0.004180375164610625 0.003906835239889141 0.00888188160899107 0.0043550187784598335 0.007342505504213407 0.008511640764061697 0.002674869469977244 
0.0035364807276474478 0.003108252546158766 0.0035530996061922363 0.004257747239165635 0.004018540904198272 0.0038705009494054868 0.003103135061691019 0.018369574193220283 0.0042657456743743416 0.0044307572388060535 
0.005136284372316915 0.04431682251400676 0.0029249519175133104 0.0034439108912748084 0.0031792431530884933 0.002752404068744034 0.0019158345794054942 0.030872057487310513 0.003000565894437516 0.002565605671598089 ];

category_names = {'1M', '2M', '3M', '4M', '5M', '6M', '7M', '8M', '9M', '10M'};

Y = precisions'*100;
Y_er = precisions_error'*100;
cat_label = categorical(category_names); %The Group Label
cat_label = reordercats(cat_label,category_names);%To Preserve Label Order
b = bar(Y,'grouped', 'BarWidth', 1.0);

set(gcf, 'units', 'inch', 'position',[0, 0, 8.5, 4]);
set(gca, 'FontName', 'Arial');
hold on;
grid on;
% Calculate the number of groups and number of bars in each group
[ngroups,nbars] = size(Y);
% Get the x coordinate of the bars
x = nan(nbars, ngroups);
for i = 1:nbars
    x(i,:) = b(i).XEndPoints;
end
errorbar(x',Y,Y_er,'k','linestyle','none', 'LineWidth', 0.9);%Adding the errorbars
hold off;
set(gca,'xticklabel',cat_label);
legend('Diamond', 'sourmash, k=7', 'sourmash, k=11', 'sourmash, k=15', 'Location', 'Best');
title('Precisions in identifying KOs by various tools', 'FontSize', 11);
xlabel('Number of reads in simulated metagenome', 'FontSize', 10);
ylabel('Average precisions in identifying KOs', 'FontSize', 10);

set(gcf, 'PaperUnits', 'inches');
set(gcf, 'PaperSize', [8.5 4]);
print(gcf, 'large_MGs_precision.pdf', '-dpdf', '-bestfit');
%%

times = [85.84866000000002 102.10369 104.29645000000001 145.72233999999997 136.99535 
660.6848299999999 791.2185199999999 1280.0197799999999 1942.41573 2096.50032 
34.05323 64.60961 96.00306 108.93476000000001 139.01288 
22.89273 28.811589999999995 36.07852999999999 41.48402 46.841429999999995 
25.717399999999998 28.0097 34.3734 42.98662 45.41233 ];

times_error = [14.040213531723793 13.488927476819645 14.67289724459692 24.303429232690604 23.539293894603123 
152.98984786443873 200.44125370575193 218.5306586689099 547.5152610378144 716.4199865775113 
12.34350209155003 10.48080261911749 9.348403603952924 14.3969790333389 14.697467186342005 
6.924446854883067 9.813875185109092 10.82099947981239 12.201638776393931 15.172532268481092 
4.744416774272682 7.844984715217741 11.424273422060592 9.357436666715945 9.942863751661289 ];

category_names = { '10K' '20K' '30K' '40K' '50K'};

Y = times';
Y_er = times_error';
cat_label = categorical(category_names); %The Group Label
cat_label = reordercats(cat_label,category_names);%To Preserve Label Order
b = bar(Y,'grouped', 'BarWidth', 1.0);

set(gcf, 'units', 'inch', 'position',[0, 0, 8.5, 4]);
set(gca, 'FontName', 'Arial');
hold on;
grid on;
% Calculate the number of groups and number of bars in each group
[ngroups,nbars] = size(Y);
% Get the x coordinate of the bars
x = nan(nbars, ngroups);
for i = 1:nbars
    x(i,:) = b(i).XEndPoints;
end
errorbar(x',Y,Y_er,'k','linestyle','none','LineWidth', 0.9);%Adding the errorbars
hold off
set(gca,'xticklabel',cat_label);
legend('Diamond', 'KofamScan', 'sourmash, k=7', 'sourmash, k=11', 'sourmash, k=15', 'Location', 'Best');

title('Running time for identifying KOs by various approaches', 'FontSize', 11);
xlabel('Number of reads in simulated metagenome', 'FontSize', 10);
ylabel('Average running time (seconds)', 'FontSize', 10);

set(gcf, 'PaperUnits', 'inches');
set(gcf, 'PaperSize', [8.5 4]);
print(gcf, 'small_MGs_runtime.pdf', '-dpdf', '-bestfit');

%%

f1s = [0.7036103948576978 0.7750977946410245 0.8065375467856569 0.8272762809240822 0.794818578441277 
0.014290895683581661 0.02121512500710925 0.025042427877745126 0.02834185370620713 0.03193758720333386 
0.3251696053558817 0.3892072121792947 0.4239863850801899 0.44600975979818236 0.5043797474387292 
0.1997364059578411 0.25238766057469414 0.2896984005724397 0.31939008790471546 0.3937483813999844 
0.18358623382030134 0.2268316072312288 0.2637787404262069 0.29542851452401153 0.3672372021854116 ];

f1s_error = [0.019247904066787138 0.014640266526369905 0.013559560234084255 0.012015689581233762 0.007837503989119202 
0.0032262319756699814 0.0024126439802736074 0.0030083131752483535 0.0025064640304727093 0.0024522811649590097 
0.010205963510648373 0.008229303410851641 0.0060232694508194585 0.00651407657504821 0.004764284921826244 
0.017668189310268933 0.017980598490932732 0.012186090592529222 0.010234158477759051 0.009649142750823812 
0.015511026660934357 0.01219650384076225 0.008804692325919967 0.010042667254320263 0.011989286884239198];

category_names = { '10K' '20K' '30K' '40K' '50K'};

Y = f1s'*100;
Y_er = f1s_error'*100;
cat_label = categorical(category_names); %The Group Label
cat_label = reordercats(cat_label,category_names);%To Preserve Label Order
b = bar(Y,'grouped', 'BarWidth', 1.0);

set(gcf, 'units', 'inch', 'position',[0, 0, 8.5, 4]);
set(gca, 'FontName', 'Arial');
hold on;
grid on;
% Calculate the number of groups and number of bars in each group
[ngroups,nbars] = size(Y);
% Get the x coordinate of the bars
x = nan(nbars, ngroups);
for i = 1:nbars
    x(i,:) = b(i).XEndPoints;
end
errorbar(x',Y,Y_er,'k','linestyle','none', 'LineWidth', 0.9);%Adding the errorbars
hold off
set(gca,'xticklabel',cat_label);
legend('Diamond', 'KofamScan', 'sourmash, k=7', 'sourmash, k=11', 'sourmash, k=15', 'Location', 'west');
title('F1 scores in identifying KOs by various approaches', 'FontSize', 11);
xlabel('Number of reads in simulated metagenome', 'FontSize', 10);
ylabel('Average F1 score', 'FontSize', 10);

set(gcf, 'PaperUnits', 'inches');
set(gcf, 'PaperSize', [8.5 4]);
print(gcf, 'small_MGs_F1.pdf', '-dpdf', '-bestfit');

%%

recalls = [0.669718077301596 0.7342472633580487 0.7647353678649813 0.7873912560463041 0.76482316780426 
0.008469368077915243 0.01227839457834251 0.014391208473335002 0.016260793171863873 0.019007919922406517 
0.23353430570985037 0.2771283976082465 0.30365335951962064 0.3215373254735706 0.401321938881159 
0.11490781795552671 0.14796113780781434 0.17262019784479093 0.19311147917856647 0.25443297092324124 
0.10436799162005853 0.13061002145703607 0.15452799712562032 0.17588597544196743 0.23255180689589147 ];

recalls_error = [0.030033170734385214 0.026906765225247587 0.025480281029699542 0.024494043055033964 0.013640216437979686 
0.0019522401706521893 0.0013877906382439274 0.0017545639874055503 0.0014934348329733109 0.0015221929353096408 
0.008342282416829614 0.006320644000580127 0.005907638048997572 0.0063279209357984525 0.005615149670169591 
0.010902120379453317 0.011871390904064982 0.008315976013053365 0.007309673849755055 0.007952213489643246 
0.009692220881452704 0.007879202728263432 0.005951260319952497 0.007101944558611059 0.009505979578359684];

category_names = { '10K' '20K' '30K' '40K' '50K'};

Y = recalls'*100;
Y_er = recalls_error'*100;
cat_label = categorical(category_names); %The Group Label
cat_label = reordercats(cat_label,category_names);%To Preserve Label Order
b = bar(Y,'grouped', 'BarWidth', 1.0);

x0 = 10;
y0 = 10;
width = 1200;
height = 400;
set(gcf,'units', 'inch', 'position',[0, 0, 8.5, 4]);
set(gca, 'FontName', 'Arial');
hold on
grid on
% Calculate the number of groups and number of bars in each group
[ngroups,nbars] = size(Y);
% Get the x coordinate of the bars
x = nan(nbars, ngroups);
for i = 1:nbars
    x(i,:) = b(i).XEndPoints;
end
errorbar(x',Y,Y_er,'k','linestyle','none', 'LineWidth', 0.9);%Adding the errorbars
hold off
set(gca,'xticklabel',cat_label);
legend('Diamond', 'KofamScan', 'sourmash, k=7', 'sourmash, k=11', 'sourmash, k=15', 'Location', 'Best');
title('Recalls in identifying KOs by various approaches', 'FontSize', 11);
xlabel('Number of reads in simulated metagenome', 'FontSize', 10);
ylabel('Average recall', 'FontSize', 10);

set(gcf, 'PaperUnits', 'inches');
set(gcf, 'PaperSize', [8.5 4]);
print(gcf, 'small_MGs_recall.pdf', '-dpdf', '-bestfit');

%%

precisions = [0.7417879179060136 0.8214159839308645 0.8537830842021454 0.8720237698407498 0.8274949154943675 
0.04585063519560459 0.0781185741415548 0.0966555408860019 0.11059268918501355 0.1000815732242107 
0.5357060420872932 0.6537523163072141 0.7025306372665394 0.7279032254749737 0.6788129944215562 
0.765660239040467 0.861150406807198 0.901623599749588 0.9237961719654179 0.8708848310725305 
0.7661098374289097 0.8636211918136146 0.9013184660368484 0.9235935963572557 0.8737953342700923 ];

precisions_error = [0.0111497501156853 0.005830455216506708 0.007147569704363173 0.0069073344555911215 0.009772115402133309 
0.009466610564050564 0.009843155719145362 0.01141928594065853 0.008797403105098753 0.007078576384421362 
0.019704600401881024 0.016837961778092055 0.00819872894241223 0.006078997671478135 0.007992636052132978 
0.03952365812955189 0.018482604409739496 0.013272566961019232 0.008786229050851989 0.005751064411028851 
0.028336072519777787 0.011606443196017476 0.008109538634984974 0.00956821836612765 0.00776196777357763];

category_names = { '10K' '20K' '30K' '40K' '50K'};

Y = precisions'*100;
Y_er = precisions_error'*100;
cat_label = categorical(category_names); %The Group Label
cat_label = reordercats(cat_label,category_names);%To Preserve Label Order
b = bar(Y,'grouped', 'BarWidth', 1.0);

set(gcf, 'units', 'inch', 'position',[0, 0, 8.5, 4]);
set(gca, 'FontName', 'Arial');
hold on;
grid on;
% Calculate the number of groups and number of bars in each group
[ngroups,nbars] = size(Y);
% Get the x coordinate of the bars
x = nan(nbars, ngroups);
for i = 1:nbars
    x(i,:) = b(i).XEndPoints;
end
errorbar(x',Y,Y_er,'k','linestyle','none', 'LineWidth', 0.9);%Adding the errorbars
hold off;
set(gca,'xticklabel',cat_label);
legend('Diamond', 'KofamScan', 'sourmash, k=7', 'sourmash, k=11', 'sourmash, k=15', 'Location', 'Best');
title('Precisions in identifying KOs by various tools', 'FontSize', 11);
xlabel('Number of reads in simulated metagenome', 'FontSize', 10);
ylabel('Average precisions in identifying KOs', 'FontSize', 10);

set(gcf, 'PaperUnits', 'inches');
set(gcf, 'PaperSize', [8.5 4]);
print(gcf, 'small_MGs_precision.pdf', '-dpdf', '-bestfit');
